name: ci
on: [push]
jobs:
  build-and-test:
    runs-on: ubuntu-20.04
    steps:
      - name: Checkout ðŸ›Ž
        uses: actions/checkout@v2

      - name: Install dependencies
        run: npm ci

      - name: Lint
        run: npm run lint  
      
      - name: Start the app
        run: BETA=true npm run start:proxy &

      - name: Run Cypress tests ðŸ§ª
        wait-on: 'https://stage.foo.redhat.com:1337/beta/edge'
        run: npx cypress run --e2e --record
        env:
          CYPRESS_RECORD_KEY: ${{secrets.CYPRESS_RECORD_KEY}}

